# 2026-02-09 - IgniteMind Academy Quiz System Fix

## Issue
Quiz submissions not persisting to Neon PostgreSQL database. Students taking quizzes and getting "success" responses, but entries not appearing in admin dashboard.

## Root Cause
Neon's serverless web sockets have auto-suspend behavior. INSERT queries were executing but not committing before the connection closed.

## Solution Applied
1. Switched from Drizzle ORM to raw SQL using `neon()` from `@neondatabase/serverless`
2. Added force-commit workaround: `await sql('SELECT 1')` after INSERT to ensure persistence

## Files Modified
- `src/app/api/quiz/save/route.ts` - Quiz submission endpoint
- `src/app/api/quiz/results/route.ts` - Results fetching endpoint

## API Endpoints
- **POST** `/api/quiz/save` - Save quiz result
- **GET** `/api/quiz/results` - Get all results (admin)
- **GET** `/api/quiz/results?email=` - Get specific student results

## Next Steps
Test if the force-commit workaround fixes the persistence issue. If not, may need to:
- Use a connection pool instead of serverless
- Add explicit transaction commits
- Check Neon console for uncommitted transactions

## Database
- Neon PostgreSQL: `postgresql://neondb_owner:...@ep-purple-violet-aimz8rur-pooler...`
- Tables: `students`, `quiz_results`, `contact_submissions`
